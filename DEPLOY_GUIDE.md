# YuwenChat å°ç™½éƒ¨ç½²å®Œå…¨æŒ‡å—

> æœ¬æ•™ç¨‹å‡è®¾ä½ ä»€ä¹ˆéƒ½ä¸ä¼šï¼Œæ¯ä¸€æ­¥éƒ½ä¼šè¯¦ç»†è¯´æ˜ï¼Œè·Ÿç€åšå°±è¡Œï¼

---

## ç›®å½•

1. [å‡†å¤‡å·¥ä½œ](#1-å‡†å¤‡å·¥ä½œ)
2. [è´­ä¹°æœåŠ¡å™¨](#2-è´­ä¹°æœåŠ¡å™¨)
3. [è´­ä¹°åŸŸå](#3-è´­ä¹°åŸŸå)
4. [å®‰è£…å®å¡”é¢æ¿](#4-å®‰è£…å®å¡”é¢æ¿)
5. [ç™»å½•å®å¡”é¢æ¿](#5-ç™»å½•å®å¡”é¢æ¿)
6. [å®‰è£…å¿…è¦è½¯ä»¶](#6-å®‰è£…å¿…è¦è½¯ä»¶)
7. [ä¸Šä¼ é¡¹ç›®ä»£ç ](#7-ä¸Šä¼ é¡¹ç›®ä»£ç )
8. [é…ç½®æ•°æ®åº“](#8-é…ç½®æ•°æ®åº“)
9. [å®‰è£…é¡¹ç›®ä¾èµ–](#9-å®‰è£…é¡¹ç›®ä¾èµ–)
10. [é…ç½®ç¯å¢ƒå˜é‡](#10-é…ç½®ç¯å¢ƒå˜é‡)
11. [æ„å»ºå‰ç«¯](#11-æ„å»ºå‰ç«¯)
12. [å¯åŠ¨åç«¯æœåŠ¡](#12-å¯åŠ¨åç«¯æœåŠ¡)
13. [åˆ›å»ºç½‘ç«™](#13-åˆ›å»ºç½‘ç«™)
14. [é…ç½® Nginx](#14-é…ç½®-nginx)
15. [ç»‘å®šåŸŸå](#15-ç»‘å®šåŸŸå)
16. [é…ç½® SSL è¯ä¹¦](#16-é…ç½®-ssl-è¯ä¹¦https)
17. [æµ‹è¯•è¿è¡Œ](#17-æµ‹è¯•è¿è¡Œ)
18. [å¸¸è§é—®é¢˜](#18-å¸¸è§é—®é¢˜)
19. [æ—¥å¸¸ç»´æŠ¤](#19-æ—¥å¸¸ç»´æŠ¤)

---

## 1. å‡†å¤‡å·¥ä½œ

### ä½ éœ€è¦å‡†å¤‡çš„ä¸œè¥¿

| ä¸œè¥¿ | è¯´æ˜ | å¤§æ¦‚è´¹ç”¨ |
|------|------|----------|
| äº‘æœåŠ¡å™¨ | è¿è¡Œä½ çš„èŠå¤©è½¯ä»¶ | çº¦ 50-100 å…ƒ/æœˆ |
| åŸŸå | ä¾‹å¦‚ `chat.example.com` | çº¦ 50-100 å…ƒ/å¹´ |
| ç”µè„‘ | ç”¨æ¥æ“ä½œ | ä½ å·²ç»æœ‰äº† |

### æ¨èçš„æœåŠ¡å™¨é…ç½®

```
æœ€ä½é…ç½®ï¼ˆ1-50äººä½¿ç”¨ï¼‰:
- CPU: 1æ ¸
- å†…å­˜: 1GB
- ç¡¬ç›˜: 20GB SSD
- å¸¦å®½: 1Mbps

æ¨èé…ç½®ï¼ˆ50-500äººä½¿ç”¨ï¼‰:
- CPU: 2æ ¸
- å†…å­˜: 2GB
- ç¡¬ç›˜: 40GB SSD
- å¸¦å®½: 3Mbps
```

---

## 2. è´­ä¹°æœåŠ¡å™¨

### é€‰æ‹©äº‘æœåŠ¡å•†

å›½å†…æ¨èï¼ˆéœ€è¦å¤‡æ¡ˆï¼Œä½†é€Ÿåº¦å¿«ï¼‰:
- é˜¿é‡Œäº‘: https://www.aliyun.com
- è…¾è®¯äº‘: https://cloud.tencent.com
- åä¸ºäº‘: https://www.huaweicloud.com

å›½å¤–æ¨èï¼ˆæ— éœ€å¤‡æ¡ˆï¼Œä½†å¯èƒ½è¢«å¢™ï¼‰:
- Vultr: https://www.vultr.com
- DigitalOcean: https://www.digitalocean.com
- Bandwagon: https://bandwagonhost.com

### ä»¥é˜¿é‡Œäº‘ä¸ºä¾‹çš„è´­ä¹°æ­¥éª¤

```
ç¬¬1æ­¥: æ‰“å¼€ https://www.aliyun.com
ç¬¬2æ­¥: ç‚¹å‡»å³ä¸Šè§’ã€Œç™»å½•ã€ï¼Œæ²¡æœ‰è´¦å·å°±æ³¨å†Œä¸€ä¸ª
ç¬¬3æ­¥: ç™»å½•åï¼Œç‚¹å‡»ã€Œäº§å“ã€->ã€Œäº‘æœåŠ¡å™¨ ECSã€
ç¬¬4æ­¥: ç‚¹å‡»ã€Œç«‹å³è´­ä¹°ã€

ç¬¬5æ­¥: é€‰æ‹©é…ç½®
  â”œâ”€â”€ ä»˜è´¹æ¨¡å¼: é€‰ã€ŒåŒ…å¹´åŒ…æœˆã€(æ›´ä¾¿å®œ)
  â”œâ”€â”€ åœ°åŸŸ: é€‰ç¦»ä½ è¿‘çš„ï¼Œæ¯”å¦‚ã€Œåä¸œ1ï¼ˆæ­å·ï¼‰ã€
  â”œâ”€â”€ å®ä¾‹è§„æ ¼: é€‰ã€Œå…±äº«å‹ã€->ã€Œ1æ ¸1Gã€æˆ–ã€Œ1æ ¸2Gã€
  â”œâ”€â”€ é•œåƒ: é€‰ã€Œå…¬å…±é•œåƒã€->ã€ŒUbuntuã€->ã€Œ22.04 64ä½ã€
  â”‚         âš ï¸ ä¸€å®šè¦é€‰ Ubuntuï¼Œä¸è¦é€‰ CentOSï¼
  â”œâ”€â”€ å­˜å‚¨: é»˜è®¤ 40GB å°±å¤Ÿäº†
  â””â”€â”€ å¸¦å®½: é€‰ã€ŒæŒ‰å›ºå®šå¸¦å®½ã€-> 1Mbps èµ·æ­¥

ç¬¬6æ­¥: ç‚¹å‡»ã€Œä¸‹ä¸€æ­¥ï¼šç½‘ç»œå’Œå®‰å…¨ç»„ã€
  â”œâ”€â”€ ç½‘ç»œ: é»˜è®¤å³å¯
  â””â”€â”€ å®‰å…¨ç»„: å‹¾é€‰ã€Œå¼€æ”¾ 22, 80, 443, 3000 ç«¯å£ã€
              å¦‚æœæ²¡æœ‰è¿™ä¸ªé€‰é¡¹ï¼Œåé¢å†é…ç½®

ç¬¬7æ­¥: ç‚¹å‡»ã€Œä¸‹ä¸€æ­¥ï¼šç³»ç»Ÿé…ç½®ã€
  â”œâ”€â”€ ç™»å½•å‡­è¯: é€‰ã€Œè‡ªå®šä¹‰å¯†ç ã€
  â”œâ”€â”€ ç™»å½•å: root
  â””â”€â”€ å¯†ç : è®¾ç½®ä¸€ä¸ªå¤æ‚å¯†ç ï¼ˆè®°ä½å®ƒï¼ï¼‰
      ä¾‹å¦‚: YuwenChat@2024

ç¬¬8æ­¥: ç‚¹å‡»ã€Œä¸‹ä¸€æ­¥ï¼šç¡®è®¤è®¢å•ã€
ç¬¬9æ­¥: ä»˜æ¬¾

ç¬¬10æ­¥: ç­‰å¾…å‡ åˆ†é’Ÿï¼ŒæœåŠ¡å™¨å°±åˆ›å»ºå¥½äº†
ç¬¬11æ­¥: åœ¨æ§åˆ¶å°æ‰¾åˆ°ä½ çš„æœåŠ¡å™¨ï¼Œè®°ä¸‹ã€Œå…¬ç½‘IPã€
        ä¾‹å¦‚: 47.98.123.456
```

### è®°å½•ä½ çš„æœåŠ¡å™¨ä¿¡æ¯

```
è¯·æŠŠä»¥ä¸‹ä¿¡æ¯è®°åœ¨è®°äº‹æœ¬é‡Œï¼Œåé¢è¦ç”¨ï¼

æœåŠ¡å™¨å…¬ç½‘IP: _________________ (ä¾‹å¦‚: 47.98.123.456)
ç™»å½•ç”¨æˆ·å: root
ç™»å½•å¯†ç : _________________
```

---

## 3. è´­ä¹°åŸŸå

### ä»€ä¹ˆæ˜¯åŸŸåï¼Ÿ

åŸŸåå°±æ˜¯ç½‘å€ï¼Œæ¯”å¦‚ `baidu.com`ã€`google.com`ã€‚
ä½ éœ€è¦ä¸€ä¸ªåŸŸåï¼Œè®©ç”¨æˆ·é€šè¿‡ `chat.yourdomain.com` è®¿é—®ä½ çš„èŠå¤©è½¯ä»¶ã€‚

### è´­ä¹°åŸŸåæ­¥éª¤ï¼ˆä»¥é˜¿é‡Œäº‘ä¸ºä¾‹ï¼‰

```
ç¬¬1æ­¥: æ‰“å¼€ https://wanwang.aliyun.com
ç¬¬2æ­¥: åœ¨æœç´¢æ¡†è¾“å…¥ä½ æƒ³è¦çš„åŸŸåï¼Œæ¯”å¦‚ "yuwenchat"
ç¬¬3æ­¥: ç³»ç»Ÿä¼šæ˜¾ç¤ºå¯ç”¨çš„åŸŸåï¼Œé€‰ä¸€ä¸ªä¾¿å®œçš„åç¼€
        æ¨è: .com (æœ€é€šç”¨) æˆ– .cn (ä¾¿å®œ)
        ä¾‹å¦‚: yuwenchat.com æˆ– yuwenchat.cn
ç¬¬4æ­¥: ç‚¹å‡»ã€ŒåŠ å…¥æ¸…å•ã€->ã€Œç«‹å³ç»“ç®—ã€
ç¬¬5æ­¥: æŒ‰æç¤ºå®Œæˆå®åè®¤è¯ï¼ˆéœ€è¦èº«ä»½è¯ï¼‰
ç¬¬6æ­¥: ä»˜æ¬¾è´­ä¹°
```

### è®°å½•ä½ çš„åŸŸå

```
ä½ çš„åŸŸå: _________________ (ä¾‹å¦‚: yuwenchat.com)
```

---

## 4. å®‰è£…å®å¡”é¢æ¿

### ä»€ä¹ˆæ˜¯å®å¡”é¢æ¿ï¼Ÿ

å®å¡”é¢æ¿æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ç®¡ç†å·¥å…·ï¼Œæœ‰å›¾å½¢ç•Œé¢ï¼Œè®©ä½ ä¸ç”¨æ•²å‘½ä»¤è¡Œå°±èƒ½ç®¡ç†æœåŠ¡å™¨ã€‚

### è¿æ¥åˆ°ä½ çš„æœåŠ¡å™¨

**Windows ç”¨æˆ·:**
```
ç¬¬1æ­¥: ä¸‹è½½ PuTTY
       åœ°å€: https://www.putty.org
       ç‚¹å‡»ã€ŒDownload PuTTYã€ä¸‹è½½å®‰è£…

ç¬¬2æ­¥: æ‰“å¼€ PuTTY
ç¬¬3æ­¥: åœ¨ã€ŒHost Nameã€è¾“å…¥ä½ çš„æœåŠ¡å™¨IP
       ä¾‹å¦‚: 47.98.123.456
ç¬¬4æ­¥: Port ä¿æŒ 22
ç¬¬5æ­¥: ç‚¹å‡»ã€ŒOpenã€
ç¬¬6æ­¥: å¼¹å‡ºçª—å£ç‚¹ã€ŒYesã€
ç¬¬7æ­¥: è¾“å…¥ç”¨æˆ·å: root ï¼ˆç„¶åæŒ‰å›è½¦ï¼‰
ç¬¬8æ­¥: è¾“å…¥å¯†ç ï¼ˆè¾“å…¥æ—¶ä¸æ˜¾ç¤ºï¼Œæ­£å¸¸çš„ï¼Œè¾“å®ŒæŒ‰å›è½¦ï¼‰
ç¬¬9æ­¥: çœ‹åˆ°ç±»ä¼¼ root@iZ... å°±è¡¨ç¤ºè¿æ¥æˆåŠŸäº†ï¼
```

**Mac ç”¨æˆ·:**
```
ç¬¬1æ­¥: æ‰“å¼€ã€Œç»ˆç«¯ã€åº”ç”¨
       (åœ¨å¯åŠ¨å°æœç´¢ã€Œç»ˆç«¯ã€æˆ–ã€ŒTerminalã€)
ç¬¬2æ­¥: è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼ˆæŠŠIPæ¢æˆä½ çš„ï¼‰:
       ssh root@47.98.123.456
ç¬¬3æ­¥: æç¤º Are you sure è¾“å…¥ yes å›è½¦
ç¬¬4æ­¥: è¾“å…¥ä½ çš„æœåŠ¡å™¨å¯†ç ï¼Œå›è½¦
ç¬¬5æ­¥: çœ‹åˆ°ç±»ä¼¼ root@iZ... å°±è¡¨ç¤ºè¿æ¥æˆåŠŸäº†ï¼
```

### å®‰è£…å®å¡”é¢æ¿

è¿æ¥æˆåŠŸåï¼Œå¤åˆ¶ä¸‹é¢è¿™ä¸€æ•´è¡Œå‘½ä»¤ï¼Œç²˜è´´åˆ°ç»ˆç«¯ï¼ŒæŒ‰å›è½¦æ‰§è¡Œ:

```bash
wget -O install.sh https://download.bt.cn/install/install-ubuntu_6.0.sh && sudo bash install.sh ed8484bec
```

```
å®‰è£…è¿‡ç¨‹å¤§çº¦ 2-5 åˆ†é’Ÿï¼ŒæœŸé—´ä¼šé—®ä½ :
  "Do you want to install Bt-Panel to the /www directory now?(y/n)"
  è¾“å…¥: y
  æŒ‰å›è½¦

å®‰è£…å®Œæˆåï¼Œå±å¹•ä¼šæ˜¾ç¤º:
==================================================================
Congratulations! Installed successfully!
==================================================================
å¤–ç½‘é¢æ¿åœ°å€: http://47.98.123.456:8888/abcdefgh
å†…ç½‘é¢æ¿åœ°å€: http://172.16.0.1:8888/abcdefgh
username: abcdefgh
password: 12345678
==================================================================

âš ï¸ é‡è¦ï¼æŠŠè¿™äº›ä¿¡æ¯å¤åˆ¶ä¿å­˜ä¸‹æ¥ï¼
```

### è®°å½•å®å¡”é¢æ¿ä¿¡æ¯

```
å®å¡”é¢æ¿åœ°å€: _________________________________
å®å¡”ç”¨æˆ·å: _________________
å®å¡”å¯†ç : _________________
```

---

## 5. ç™»å½•å®å¡”é¢æ¿

```
ç¬¬1æ­¥: æ‰“å¼€æµè§ˆå™¨ï¼ˆChromeã€Edgeã€Safari éƒ½è¡Œï¼‰
ç¬¬2æ­¥: åœ¨åœ°å€æ è¾“å…¥å®å¡”é¢æ¿åœ°å€
       ä¾‹å¦‚: http://47.98.123.456:8888/abcdefgh
ç¬¬3æ­¥: è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
ç¬¬4æ­¥: ç™»å½•æˆåŠŸï¼

ç¬¬5æ­¥: é¦–æ¬¡ç™»å½•ä¼šå¼¹å‡ºã€Œæ¨èå®‰è£…å¥—ä»¶ã€
       âš ï¸ å…ˆç‚¹ã€ŒÃ—ã€å…³æ‰ï¼Œä¸è¦è£…ï¼æˆ‘ä»¬æ‰‹åŠ¨é€‰æ‹©è¦è£…çš„
```

---

## 6. å®‰è£…å¿…è¦è½¯ä»¶

### 6.1 å®‰è£… PM2 ç®¡ç†å™¨ï¼ˆç”¨æ¥è¿è¡Œ Node.jsï¼‰

```
ç¬¬1æ­¥: åœ¨å®å¡”é¢æ¿å·¦ä¾§èœå•ï¼Œç‚¹å‡»ã€Œè½¯ä»¶å•†åº—ã€
ç¬¬2æ­¥: åœ¨æœç´¢æ¡†è¾“å…¥ã€ŒPM2ã€
ç¬¬3æ­¥: æ‰¾åˆ°ã€ŒPM2ç®¡ç†å™¨ã€ï¼Œç‚¹å‡»ã€Œå®‰è£…ã€
ç¬¬4æ­¥: å¼¹å‡ºæ¡†ç‚¹å‡»ã€Œç¡®å®šã€
ç¬¬5æ­¥: ç­‰å¾…å®‰è£…å®Œæˆï¼ˆå¤§çº¦2-3åˆ†é’Ÿï¼‰
ç¬¬6æ­¥: å®‰è£…å®Œæˆåï¼ŒçŠ¶æ€ä¼šå˜æˆç»¿è‰²çš„ã€Œè¿è¡Œä¸­ã€
```

### 6.2 å®‰è£… Nginxï¼ˆç”¨æ¥åšç½‘ç«™æœåŠ¡å™¨ï¼‰

```
ç¬¬1æ­¥: åœ¨è½¯ä»¶å•†åº—æœç´¢ã€Œnginxã€
ç¬¬2æ­¥: æ‰¾åˆ°ã€ŒNginxã€ï¼ˆä¸æ˜¯ OpenRestyï¼‰ï¼Œç‚¹å‡»ã€Œå®‰è£…ã€
ç¬¬3æ­¥: ç‰ˆæœ¬é€‰æ‹©ã€Œ1.24ã€æˆ–æœ€æ–°çš„ç¨³å®šç‰ˆ
ç¬¬4æ­¥: å‹¾é€‰ã€Œæé€Ÿå®‰è£…ã€
ç¬¬5æ­¥: ç‚¹å‡»ã€Œç¡®å®šã€
ç¬¬6æ­¥: ç­‰å¾…å®‰è£…å®Œæˆï¼ˆå¤§çº¦1-2åˆ†é’Ÿï¼‰
```

### 6.3 æ£€æŸ¥ Node.js ç‰ˆæœ¬

```
ç¬¬1æ­¥: ç‚¹å‡»å·¦ä¾§ã€Œç»ˆç«¯ã€
ç¬¬2æ­¥: è¾“å…¥å‘½ä»¤: node -v
ç¬¬3æ­¥: åº”è¯¥æ˜¾ç¤ºç±»ä¼¼ v18.x.x æˆ– v20.x.x
       å¦‚æœç‰ˆæœ¬ä½äº 18ï¼Œéœ€è¦å‡çº§ï¼ˆè§ä¸‹æ–¹ï¼‰
```

**å¦‚æœ Node.js ç‰ˆæœ¬ä½äº 18:**
```
åœ¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:

# å®‰è£… n æ¨¡å—
npm install -g n

# å®‰è£…æœ€æ–° LTS ç‰ˆæœ¬
n lts

# é‡å¯ç»ˆç«¯ï¼Œå†æ¬¡æ£€æŸ¥ç‰ˆæœ¬
node -v
```

---

## 7. ä¸Šä¼ é¡¹ç›®ä»£ç 

### 7.1 åˆ›å»ºé¡¹ç›®ç›®å½•

```
ç¬¬1æ­¥: åœ¨å®å¡”é¢æ¿å·¦ä¾§ï¼Œç‚¹å‡»ã€Œæ–‡ä»¶ã€
ç¬¬2æ­¥: åœ¨è·¯å¾„æ è¾“å…¥: /www/wwwroot
ç¬¬3æ­¥: æŒ‰å›è½¦è¿›å…¥è¯¥ç›®å½•
ç¬¬4æ­¥: ç‚¹å‡»ã€Œæ–°å»ºç›®å½•ã€
ç¬¬5æ­¥: è¾“å…¥ç›®å½•å: yuwenchat
ç¬¬6æ­¥: ç‚¹å‡»ã€Œç¡®å®šã€
```

### 7.2 ä¸Šä¼ é¡¹ç›®æ–‡ä»¶

**æ–¹æ³•ä¸€ï¼šé€šè¿‡å®å¡”é¢æ¿ä¸Šä¼ ï¼ˆæ¨èå°ç™½ä½¿ç”¨ï¼‰**
```
ç¬¬1æ­¥: åŒå‡»è¿›å…¥ yuwenchat ç›®å½•
ç¬¬2æ­¥: ç‚¹å‡»ã€Œä¸Šä¼ ã€
ç¬¬3æ­¥: é€‰æ‹©é¡¹ç›®å‹ç¼©åŒ…ï¼ˆ.zip æ ¼å¼ï¼‰
ç¬¬4æ­¥: ç­‰å¾…ä¸Šä¼ å®Œæˆ
ç¬¬5æ­¥: å³é”®ç‚¹å‡»å‹ç¼©åŒ… ->ã€Œè§£å‹ã€
ç¬¬6æ­¥: è§£å‹åˆ°å½“å‰ç›®å½•
```

**æ–¹æ³•äºŒï¼šé€šè¿‡ Git æ‹‰å–ï¼ˆå¦‚æœä»£ç åœ¨ GitHubï¼‰**
```
ç¬¬1æ­¥: ç‚¹å‡»å®å¡”å·¦ä¾§ã€Œç»ˆç«¯ã€
ç¬¬2æ­¥: æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:

cd /www/wwwroot
git clone https://github.com/ä½ çš„ç”¨æˆ·å/yuwenchat.git
```

### 7.3 ç¡®è®¤ç›®å½•ç»“æ„

ä¸Šä¼ /è§£å‹åï¼Œç›®å½•ç»“æ„åº”è¯¥æ˜¯è¿™æ ·çš„:
```
/www/wwwroot/yuwenchat/
â”œâ”€â”€ client/          # å‰ç«¯ä»£ç 
â”œâ”€â”€ server/          # åç«¯ä»£ç 
â”œâ”€â”€ PLAN.md
â””â”€â”€ README.md
```

åœ¨å®å¡”ã€Œç»ˆç«¯ã€ä¸­éªŒè¯:
```bash
ls /www/wwwroot/yuwenchat/
# åº”è¯¥æ˜¾ç¤º: client  server  PLAN.md  README.md
```

---

## 8. é…ç½®æ•°æ®åº“

æˆ‘ä»¬ä½¿ç”¨ SQLiteï¼Œä¸éœ€è¦å®‰è£…é¢å¤–çš„æ•°æ®åº“è½¯ä»¶ï¼SQLite çš„æ•°æ®åº“å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚

### åˆ›å»ºæ•°æ®åº“ç›®å½•

```
ç¬¬1æ­¥: åœ¨å®å¡”ã€Œç»ˆç«¯ã€æ‰§è¡Œ:

mkdir -p /www/wwwroot/yuwenchat/server/data

# è®¾ç½®æƒé™
chmod 755 /www/wwwroot/yuwenchat/server/data
```

æ•°æ®åº“æ–‡ä»¶ä¼šåœ¨ç¨‹åºé¦–æ¬¡è¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»ºã€‚

---

## 9. å®‰è£…é¡¹ç›®ä¾èµ–

### 9.1 å®‰è£…åç«¯ä¾èµ–

åœ¨å®å¡”ã€Œç»ˆç«¯ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:

```bash
# è¿›å…¥åç«¯ç›®å½•
cd /www/wwwroot/yuwenchat/server

# å®‰è£…ä¾èµ–ï¼ˆè¿™ä¸€æ­¥éœ€è¦ç­‰å¾…1-3åˆ†é’Ÿï¼‰
npm install

# å¦‚æœæŠ¥é”™ï¼Œå°è¯•ç”¨ä»¥ä¸‹å‘½ä»¤
npm install --registry=https://registry.npmmirror.com
```

**å¯èƒ½é‡åˆ°çš„é—®é¢˜:**

é—®é¢˜1: `npm: command not found`
```
è§£å†³: PM2ç®¡ç†å™¨æ²¡è£…å¥½ï¼Œå»è½¯ä»¶å•†åº—é‡æ–°å®‰è£…
```

é—®é¢˜2: `node-gyp` æˆ– `better-sqlite3` ç¼–è¯‘é”™è¯¯
```
è§£å†³: æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ç¼–è¯‘å·¥å…·
apt update
apt install -y build-essential python3
npm install
```

é—®é¢˜3: ç½‘ç»œè¶…æ—¶
```
è§£å†³: ä½¿ç”¨å›½å†…é•œåƒ
npm config set registry https://registry.npmmirror.com
npm install
```

### 9.2 å®‰è£…å‰ç«¯ä¾èµ–

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd /www/wwwroot/yuwenchat/client

# å®‰è£…ä¾èµ–
npm install

# å¦‚æœæŠ¥é”™ï¼Œä½¿ç”¨å›½å†…é•œåƒ
npm install --registry=https://registry.npmmirror.com
```

---

## 10. é…ç½®ç¯å¢ƒå˜é‡

### 10.1 åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶

```bash
# è¿›å…¥åç«¯ç›®å½•
cd /www/wwwroot/yuwenchat/server

# åˆ›å»º .env æ–‡ä»¶
nano .env
```

### 10.2 å†™å…¥ä»¥ä¸‹å†…å®¹

```bash
# æœåŠ¡å™¨é…ç½®
PORT=3000
NODE_ENV=production

# JWT å¯†é’¥ï¼ˆè¯·ä¿®æ”¹æˆéšæœºå­—ç¬¦ä¸²ï¼ï¼‰
JWT_SECRET=è¿™é‡Œæ”¹æˆä¸€ä¸²éšæœºå­—ç¬¦æ¯”å¦‚abc123xyz789qwe456

# å‰ç«¯åœ°å€ï¼ˆæ”¹æˆä½ çš„åŸŸåï¼‰
CLIENT_URL=https://chat.yourdomain.com

# æ•°æ®åº“è·¯å¾„
DB_PATH=./data/chat.db
```

**å¦‚ä½•ç”Ÿæˆéšæœºå­—ç¬¦ä¸²ï¼Ÿ**
åœ¨ç»ˆç«¯æ‰§è¡Œ:
```bash
openssl rand -hex 32
```
æŠŠç”Ÿæˆçš„å­—ç¬¦ä¸²å¤åˆ¶åˆ° JWT_SECRET åé¢ã€‚

### 10.3 ä¿å­˜æ–‡ä»¶

```
æŒ‰ Ctrl + X
æŒ‰ Y
æŒ‰å›è½¦
```

### 10.4 æˆ–è€…ç”¨å®å¡”é¢æ¿åˆ›å»ºï¼ˆæ›´ç®€å•ï¼‰

```
ç¬¬1æ­¥: åœ¨å®å¡”é¢æ¿ç‚¹å‡»ã€Œæ–‡ä»¶ã€
ç¬¬2æ­¥: è¿›å…¥ /www/wwwroot/yuwenchat/server/
ç¬¬3æ­¥: ç‚¹å‡»ã€Œæ–°å»ºæ–‡ä»¶ã€
ç¬¬4æ­¥: æ–‡ä»¶åè¾“å…¥: .env
ç¬¬5æ­¥: ç‚¹å‡»ã€Œç¡®å®šã€
ç¬¬6æ­¥: åŒå‡» .env æ–‡ä»¶ç¼–è¾‘
ç¬¬7æ­¥: ç²˜è´´ä¸Šé¢çš„å†…å®¹
ç¬¬8æ­¥: ç‚¹å‡»ã€Œä¿å­˜ã€
```

---

## 11. æ„å»ºå‰ç«¯

æ„å»ºå°±æ˜¯æŠŠå¼€å‘ä»£ç è½¬æ¢æˆæµè§ˆå™¨å¯ä»¥è¿è¡Œçš„ä»£ç ã€‚

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd /www/wwwroot/yuwenchat/client

# æ„å»ºï¼ˆè¿™ä¸€æ­¥éœ€è¦1-2åˆ†é’Ÿï¼‰
npm run build
```

æ„å»ºæˆåŠŸåï¼Œä¼šç”Ÿæˆä¸€ä¸ª `dist` ç›®å½•:
```
/www/wwwroot/yuwenchat/client/dist/
â”œâ”€â”€ index.html
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ index-xxx.js
â”‚   â””â”€â”€ index-xxx.css
â””â”€â”€ ...
```

éªŒè¯:
```bash
ls /www/wwwroot/yuwenchat/client/dist/
# åº”è¯¥çœ‹åˆ° index.html å’Œ assets ç›®å½•
```

---

## 12. å¯åŠ¨åç«¯æœåŠ¡

### 12.1 ä½¿ç”¨ PM2 å¯åŠ¨

```bash
# è¿›å…¥åç«¯ç›®å½•
cd /www/wwwroot/yuwenchat/server

# ä½¿ç”¨ PM2 å¯åŠ¨
pm2 start src/index.js --name yuwenchat

# æŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸ
pm2 list
```

æˆåŠŸçš„è¯ä¼šæ˜¾ç¤º:
```
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id  â”‚ name        â”‚ namespace   â”‚ status  â”‚ cpu     â”‚ memory   â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0   â”‚ yuwenchat   â”‚ default     â”‚ online  â”‚ 0%      â”‚ 45.0mb   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 12.2 è®¾ç½®å¼€æœºè‡ªå¯

```bash
pm2 save
pm2 startup
```

### 12.3 æˆ–è€…ç”¨å®å¡” PM2 ç®¡ç†å™¨ï¼ˆå›¾å½¢ç•Œé¢ï¼‰

```
ç¬¬1æ­¥: åœ¨å®å¡”é¢æ¿å·¦ä¾§ç‚¹å‡»ã€Œè½¯ä»¶å•†åº—ã€
ç¬¬2æ­¥: æ‰¾åˆ°ã€ŒPM2ç®¡ç†å™¨ã€ï¼Œç‚¹å‡»ã€Œè®¾ç½®ã€
ç¬¬3æ­¥: ç‚¹å‡»ã€Œæ·»åŠ é¡¹ç›®ã€
ç¬¬4æ­¥: å¡«å†™ä¿¡æ¯:
       - å¯åŠ¨æ–‡ä»¶: /www/wwwroot/yuwenchat/server/src/index.js
       - é¡¹ç›®åç§°: yuwenchat
       - è¿è¡Œç›®å½•: /www/wwwroot/yuwenchat/server
ç¬¬5æ­¥: ç‚¹å‡»ã€Œç¡®å®šã€
ç¬¬6æ­¥: é¡¹ç›®ä¼šè‡ªåŠ¨å¯åŠ¨
```

### 12.4 æŸ¥çœ‹æ—¥å¿—ï¼ˆæ’æŸ¥é—®é¢˜ç”¨ï¼‰

```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
pm2 logs yuwenchat

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
pm2 logs yuwenchat --err

# æŒ‰ Ctrl+C é€€å‡ºæ—¥å¿—æŸ¥çœ‹
```

---

## 13. åˆ›å»ºç½‘ç«™

### 13.1 åœ¨å®å¡”é¢æ¿åˆ›å»ºç½‘ç«™

```
ç¬¬1æ­¥: ç‚¹å‡»å·¦ä¾§ã€Œç½‘ç«™ã€
ç¬¬2æ­¥: ç‚¹å‡»ã€Œæ·»åŠ ç«™ç‚¹ã€
ç¬¬3æ­¥: å¡«å†™ä¿¡æ¯:
       - åŸŸå: chat.yourdomain.com ï¼ˆæ¢æˆä½ çš„åŸŸåï¼‰
       - æ ¹ç›®å½•: /www/wwwroot/yuwenchat/client/dist
       - PHPç‰ˆæœ¬: é€‰ã€Œçº¯é™æ€ã€
       - æ•°æ®åº“: ä¸åˆ›å»º
ç¬¬4æ­¥: ç‚¹å‡»ã€Œæäº¤ã€
```

---

## 14. é…ç½® Nginx

### 14.1 ä¿®æ”¹ç½‘ç«™é…ç½®

```
ç¬¬1æ­¥: åœ¨ã€Œç½‘ç«™ã€åˆ—è¡¨æ‰¾åˆ°ä½ åˆšåˆ›å»ºçš„ç½‘ç«™
ç¬¬2æ­¥: ç‚¹å‡»ç½‘ç«™åç§°ï¼ˆæˆ–ç‚¹å‡»ã€Œè®¾ç½®ã€ï¼‰
ç¬¬3æ­¥: ç‚¹å‡»å·¦ä¾§ã€Œé…ç½®æ–‡ä»¶ã€
ç¬¬4æ­¥: åˆ é™¤åŸæœ‰å†…å®¹ï¼Œç²˜è´´ä»¥ä¸‹é…ç½®:
```

```nginx
server {
    listen 80;
    server_name chat.yourdomain.com;  # æ”¹æˆä½ çš„åŸŸå

    # å‰ç«¯é™æ€æ–‡ä»¶
    root /www/wwwroot/yuwenchat/client/dist;
    index index.html;

    # å‰ç«¯è·¯ç”±æ”¯æŒï¼ˆVue Routerï¼‰
    location / {
        try_files $uri $uri/ /index.html;
    }

    # åç«¯ API ä»£ç†
    location /api {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # WebSocket ä»£ç†ï¼ˆèŠå¤©å®æ—¶é€šä¿¡ï¼‰
    location /socket.io {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket è¶…æ—¶è®¾ç½®
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # ç¦æ­¢è®¿é—®éšè—æ–‡ä»¶
    location ~ /\. {
        deny all;
    }

    # æ—¥å¿—
    access_log /www/wwwlogs/yuwenchat.access.log;
    error_log /www/wwwlogs/yuwenchat.error.log;
}
```

```
ç¬¬5æ­¥: æŠŠ chat.yourdomain.com æ”¹æˆä½ çš„çœŸå®åŸŸå
ç¬¬6æ­¥: ç‚¹å‡»ã€Œä¿å­˜ã€
```

### 14.2 æµ‹è¯• Nginx é…ç½®

```bash
# åœ¨å®å¡”ç»ˆç«¯æ‰§è¡Œ
nginx -t
```

å¦‚æœæ˜¾ç¤º:
```
nginx: configuration file /www/server/nginx/conf/nginx.conf test is successful
```
è¯´æ˜é…ç½®æ­£ç¡®ï¼

### 14.3 é‡è½½ Nginx

```bash
nginx -s reload
```

æˆ–è€…åœ¨å®å¡”é¢æ¿:
```
è½¯ä»¶å•†åº— -> Nginx -> è®¾ç½® -> é‡è½½é…ç½®
```

---

## 15. ç»‘å®šåŸŸå

### 15.1 æ·»åŠ åŸŸåè§£æ

```
ç¬¬1æ­¥: ç™»å½•ä½ çš„åŸŸåç®¡ç†åå°
       é˜¿é‡Œäº‘: https://dc.console.aliyun.com
       è…¾è®¯äº‘: https://console.cloud.tencent.com/cns

ç¬¬2æ­¥: æ‰¾åˆ°ä½ çš„åŸŸåï¼Œç‚¹å‡»ã€Œè§£æã€æˆ–ã€Œè§£æè®¾ç½®ã€

ç¬¬3æ­¥: ç‚¹å‡»ã€Œæ·»åŠ è®°å½•ã€

ç¬¬4æ­¥: å¡«å†™ä¿¡æ¯:
       - è®°å½•ç±»å‹: A
       - ä¸»æœºè®°å½•: chat ï¼ˆå¦‚æœæƒ³ç”¨ chat.yourdomain.comï¼‰
                   æˆ– @ ï¼ˆå¦‚æœæƒ³ç”¨ yourdomain.comï¼‰
       - è®°å½•å€¼: ä½ çš„æœåŠ¡å™¨IPï¼ˆä¾‹å¦‚ 47.98.123.456ï¼‰
       - TTL: é»˜è®¤ï¼ˆ10åˆ†é’Ÿï¼‰

ç¬¬5æ­¥: ç‚¹å‡»ã€Œç¡®å®šã€
```

### 15.2 ç­‰å¾…è§£æç”Ÿæ•ˆ

åŸŸåè§£æéœ€è¦å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ä¸ç­‰ã€‚å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•æ£€æŸ¥:

```bash
# åœ¨ç”µè„‘ç»ˆç«¯æˆ–å®å¡”ç»ˆç«¯æ‰§è¡Œ
ping chat.yourdomain.com
```

å¦‚æœæ˜¾ç¤ºä½ çš„æœåŠ¡å™¨IPï¼Œè¯´æ˜è§£ææˆåŠŸäº†ï¼

### 15.3 æµ‹è¯•è®¿é—®

æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®: `http://chat.yourdomain.com`

å¦‚æœçœ‹åˆ°é¡µé¢ï¼ˆå¯èƒ½æ˜¯æŠ¥é”™é¡µé¢ï¼‰ï¼Œè¯´æ˜åŸŸåé…ç½®æˆåŠŸï¼

---

## 16. é…ç½® SSL è¯ä¹¦ï¼ˆHTTPSï¼‰

### ä¸ºä»€ä¹ˆéœ€è¦ HTTPSï¼Ÿ

1. åŠ å¯†ä¼ è¾“ï¼Œé˜²æ­¢è¢«çªƒå¬
2. ç°ä»£æµè§ˆå™¨è¦æ±‚ï¼ˆå¦åˆ™ä¼šæ˜¾ç¤ºã€Œä¸å®‰å…¨ã€ï¼‰
3. ç«¯å¯¹ç«¯åŠ å¯†çš„å‰æä¿éšœ

### 16.1 ç”³è¯·å…è´¹è¯ä¹¦ï¼ˆLet's Encryptï¼‰

```
ç¬¬1æ­¥: åœ¨å®å¡”é¢æ¿ç‚¹å‡»ã€Œç½‘ç«™ã€
ç¬¬2æ­¥: æ‰¾åˆ°ä½ çš„ç½‘ç«™ï¼Œç‚¹å‡»ã€Œè®¾ç½®ã€
ç¬¬3æ­¥: ç‚¹å‡»å·¦ä¾§ã€ŒSSLã€
ç¬¬4æ­¥: ç‚¹å‡»ã€ŒLet's Encryptã€
ç¬¬5æ­¥: å‹¾é€‰ä½ çš„åŸŸå
ç¬¬6æ­¥: ç‚¹å‡»ã€Œç”³è¯·ã€
ç¬¬7æ­¥: ç­‰å¾…ç”³è¯·å®Œæˆï¼ˆå¤§çº¦30ç§’ï¼‰
```

ç”³è¯·æˆåŠŸå:
```
ç¬¬8æ­¥: å¼€å¯ã€Œå¼ºåˆ¶ HTTPSã€ï¼ˆå³ä¸Šè§’å¼€å…³ï¼‰
```

### 16.2 å¦‚æœç”³è¯·å¤±è´¥

**å¸¸è§åŸå› åŠè§£å†³æ–¹æ³•:**

åŸå› 1: åŸŸåè§£æè¿˜æ²¡ç”Ÿæ•ˆ
```
è§£å†³: ç­‰å¾…10åˆ†é’Ÿåå†è¯•
```

åŸå› 2: 80ç«¯å£æ²¡å¼€æ”¾
```
è§£å†³:
1. å»äº‘æœåŠ¡å•†æ§åˆ¶å°
2. æ‰¾åˆ°ã€Œå®‰å…¨ç»„ã€
3. æ·»åŠ è§„åˆ™ï¼Œå¼€æ”¾ 80 å’Œ 443 ç«¯å£
```

åŸå› 3: åŸŸåæ²¡æœ‰å¤‡æ¡ˆï¼ˆå›½å†…æœåŠ¡å™¨ï¼‰
```
è§£å†³:
1. å»åŸŸåæœåŠ¡å•†æäº¤å¤‡æ¡ˆ
2. æˆ–è€…ä½¿ç”¨å›½å¤–æœåŠ¡å™¨
```

### 16.3 è¯ä¹¦è‡ªåŠ¨ç»­æœŸ

Let's Encrypt è¯ä¹¦æœ‰æ•ˆæœŸ90å¤©ï¼Œå®å¡”ä¼šè‡ªåŠ¨ç»­æœŸï¼Œä¸ç”¨ç®¡ã€‚

ç¡®è®¤è‡ªåŠ¨ç»­æœŸå·²å¼€å¯:
```
ç½‘ç«™è®¾ç½® -> SSL -> çœ‹åˆ°ã€Œå·²å¼€å¯è‡ªåŠ¨ç»­ç­¾ã€
```

---

## 17. æµ‹è¯•è¿è¡Œ

### 17.1 æ£€æŸ¥æ¸…å•

åœ¨æµè§ˆå™¨æ‰“å¼€ `https://chat.yourdomain.com`ï¼Œæ£€æŸ¥ä»¥ä¸‹å†…å®¹:

| æ£€æŸ¥é¡¹ | é¢„æœŸç»“æœ | å¦‚æœå¤±è´¥ |
|--------|----------|----------|
| é¡µé¢èƒ½æ‰“å¼€ | æ˜¾ç¤ºç™»å½•/æ³¨å†Œé¡µé¢ | æ£€æŸ¥Nginxé…ç½® |
| åœ°å€æ æœ‰é” | æ˜¾ç¤ºå°é”å›¾æ ‡ | æ£€æŸ¥SSLè¯ä¹¦ |
| å¯ä»¥æ³¨å†Œ | æ³¨å†ŒæˆåŠŸè·³è½¬ | æ£€æŸ¥åç«¯æœåŠ¡ |
| å¯ä»¥ç™»å½• | ç™»å½•æˆåŠŸè¿›å…¥èŠå¤© | æ£€æŸ¥æ•°æ®åº“ |
| å¯ä»¥å‘æ¶ˆæ¯ | æ¶ˆæ¯å®æ—¶æ˜¾ç¤º | æ£€æŸ¥WebSocket |

### 17.2 æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
# æ£€æŸ¥ PM2 æœåŠ¡
pm2 list

# æ£€æŸ¥åç«¯æ—¥å¿—
pm2 logs yuwenchat --lines 50

# æ£€æŸ¥ Nginx çŠ¶æ€
systemctl status nginx

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep 3000
```

### 17.3 æµ‹è¯• API

```bash
# æµ‹è¯•åç«¯æ˜¯å¦æ­£å¸¸å“åº”
curl http://127.0.0.1:3000/api/health

# åº”è¯¥è¿”å›ç±»ä¼¼: {"status":"ok"}
```

---

## 18. å¸¸è§é—®é¢˜

### Q1: é¡µé¢æ˜¾ç¤º 502 Bad Gateway

**åŸå› :** åç«¯æœåŠ¡æ²¡å¯åŠ¨æˆ–å´©æºƒäº†

**è§£å†³:**
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 list

# å¦‚æœçŠ¶æ€æ˜¯ erroredï¼ŒæŸ¥çœ‹æ—¥å¿—
pm2 logs yuwenchat --err

# é‡å¯æœåŠ¡
pm2 restart yuwenchat
```

### Q2: é¡µé¢æ˜¾ç¤º 404 Not Found

**åŸå› :** å‰ç«¯æ–‡ä»¶æ²¡æ‰¾åˆ°

**è§£å†³:**
```bash
# æ£€æŸ¥ dist ç›®å½•æ˜¯å¦å­˜åœ¨
ls /www/wwwroot/yuwenchat/client/dist/

# å¦‚æœä¸å­˜åœ¨ï¼Œé‡æ–°æ„å»º
cd /www/wwwroot/yuwenchat/client
npm run build
```

### Q3: æ³¨å†Œ/ç™»å½•è¯·æ±‚å¤±è´¥

**åŸå› :** API ä»£ç†é…ç½®æœ‰é—®é¢˜

**è§£å†³:**
```bash
# æ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ
curl http://127.0.0.1:3000/api/health

# æ£€æŸ¥ Nginx é…ç½®
nginx -t

# é‡è½½ Nginx
nginx -s reload
```

### Q4: WebSocket è¿æ¥å¤±è´¥ï¼Œæ¶ˆæ¯å‘ä¸å‡ºå»

**åŸå› :** WebSocket ä»£ç†æ²¡é…ç½®å¥½

**è§£å†³:**
1. æ£€æŸ¥ Nginx é…ç½®ä¸­ `/socket.io` éƒ¨åˆ†
2. ç¡®ä¿æœ‰ `Upgrade` å’Œ `Connection` å¤´
3. é‡è½½ Nginx

### Q5: æ•°æ®åº“é”™è¯¯

**åŸå› :** æƒé™é—®é¢˜æˆ–è·¯å¾„é”™è¯¯

**è§£å†³:**
```bash
# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶
ls -la /www/wwwroot/yuwenchat/server/data/

# è®¾ç½®æƒé™
chmod 755 /www/wwwroot/yuwenchat/server/data
chmod 644 /www/wwwroot/yuwenchat/server/data/chat.db

# é‡å¯æœåŠ¡
pm2 restart yuwenchat
```

### Q6: æœåŠ¡å™¨é‡å¯åç½‘ç«™æ‰“ä¸å¼€

**åŸå› :** æœåŠ¡æ²¡æœ‰è‡ªåŠ¨å¯åŠ¨

**è§£å†³:**
```bash
# è®¾ç½® PM2 å¼€æœºè‡ªå¯
pm2 startup
pm2 save

# æ‰‹åŠ¨å¯åŠ¨
pm2 start yuwenchat
```

### Q7: SSL è¯ä¹¦è¿‡æœŸ

**åŸå› :** è‡ªåŠ¨ç»­æœŸå¤±è´¥

**è§£å†³:**
```
å®å¡”é¢æ¿ -> ç½‘ç«™ -> è®¾ç½® -> SSL -> é‡æ–°ç”³è¯·
```

### Q8: å†…å­˜ä¸è¶³å¯¼è‡´å´©æºƒ

**åŸå› :** æœåŠ¡å™¨é…ç½®å¤ªä½

**è§£å†³:**
```bash
# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
free -m

# æ·»åŠ  swapï¼ˆè™šæ‹Ÿå†…å­˜ï¼‰
fallocate -l 1G /swapfile
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile
echo '/swapfile none swap sw 0 0' >> /etc/fstab
```

---

## 19. æ—¥å¸¸ç»´æŠ¤

### 19.1 æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
# æ¯æ—¥æ£€æŸ¥
pm2 list
pm2 monit  # å®æ—¶ç›‘æ§ï¼ˆæŒ‰ Ctrl+C é€€å‡ºï¼‰
```

### 19.2 æŸ¥çœ‹æ—¥å¿—

```bash
# åº”ç”¨æ—¥å¿—
pm2 logs yuwenchat

# Nginx è®¿é—®æ—¥å¿—
tail -f /www/wwwlogs/yuwenchat.access.log

# Nginx é”™è¯¯æ—¥å¿—
tail -f /www/wwwlogs/yuwenchat.error.log
```

### 19.3 å¤‡ä»½æ•°æ®

**æ‰‹åŠ¨å¤‡ä»½:**
```bash
# å¤‡ä»½æ•°æ®åº“
cp /www/wwwroot/yuwenchat/server/data/chat.db /root/backup/chat-$(date +%Y%m%d).db
```

**è‡ªåŠ¨å¤‡ä»½ï¼ˆæ¨èï¼‰:**
```
å®å¡”é¢æ¿ -> è®¡åˆ’ä»»åŠ¡ -> æ·»åŠ ä»»åŠ¡
- ä»»åŠ¡ç±»å‹: Shellè„šæœ¬
- ä»»åŠ¡åç§°: å¤‡ä»½èŠå¤©æ•°æ®
- æ‰§è¡Œå‘¨æœŸ: æ¯å¤©å‡Œæ™¨3ç‚¹
- è„šæœ¬å†…å®¹:
  mkdir -p /www/backup/yuwenchat
  cp /www/wwwroot/yuwenchat/server/data/chat.db /www/backup/yuwenchat/chat-$(date +%Y%m%d).db
  # åªä¿ç•™æœ€è¿‘30å¤©çš„å¤‡ä»½
  find /www/backup/yuwenchat -name "*.db" -mtime +30 -delete
```

### 19.4 æ›´æ–°ä»£ç 

```bash
cd /www/wwwroot/yuwenchat

# æ‹‰å–æœ€æ–°ä»£ç 
git pull

# æ›´æ–°åç«¯ä¾èµ–å¹¶é‡å¯
cd server
npm install
pm2 restart yuwenchat

# æ›´æ–°å‰ç«¯ä¾èµ–å¹¶é‡æ–°æ„å»º
cd ../client
npm install
npm run build
```

### 19.5 æœåŠ¡å™¨å®‰å…¨

```
1. å®šæœŸæ›´æ–°å®å¡”é¢æ¿
   è½¯ä»¶å•†åº— -> æ£€æŸ¥æ›´æ–°

2. å®šæœŸæ›´æ–°ç³»ç»Ÿ
   ç»ˆç«¯æ‰§è¡Œ: apt update && apt upgrade -y

3. ä¿®æ”¹å®å¡”é»˜è®¤ç«¯å£
   é¢æ¿è®¾ç½® -> å®‰å…¨è®¾ç½® -> é¢æ¿ç«¯å£

4. è®¾ç½®å®å¡”é¢æ¿è®¿é—®é™åˆ¶
   é¢æ¿è®¾ç½® -> å®‰å…¨è®¾ç½® -> æˆæƒIP
```

---

## é™„å½•ï¼šå®Œæ•´å‘½ä»¤é€ŸæŸ¥è¡¨

### é¡¹ç›®éƒ¨ç½²
```bash
# å…‹éš†é¡¹ç›®
cd /www/wwwroot
git clone <é¡¹ç›®åœ°å€> yuwenchat

# å®‰è£…åç«¯ä¾èµ–
cd yuwenchat/server
npm install

# å®‰è£…å‰ç«¯ä¾èµ–å¹¶æ„å»º
cd ../client
npm install
npm run build

# å¯åŠ¨åç«¯
cd ../server
pm2 start src/index.js --name yuwenchat
pm2 save
```

### æ—¥å¸¸è¿ç»´
```bash
pm2 list              # æŸ¥çœ‹æœåŠ¡çŠ¶æ€
pm2 logs yuwenchat    # æŸ¥çœ‹æ—¥å¿—
pm2 restart yuwenchat # é‡å¯æœåŠ¡
pm2 stop yuwenchat    # åœæ­¢æœåŠ¡
pm2 delete yuwenchat  # åˆ é™¤æœåŠ¡
nginx -t              # æµ‹è¯•Nginxé…ç½®
nginx -s reload       # é‡è½½Nginxé…ç½®
```

### æ•…éšœæ’æŸ¥
```bash
pm2 logs yuwenchat --err --lines 100  # æŸ¥çœ‹é”™è¯¯æ—¥å¿—
curl http://127.0.0.1:3000/api/health # æµ‹è¯•åç«¯
netstat -tlnp | grep 3000             # æ£€æŸ¥ç«¯å£
free -m                                # æ£€æŸ¥å†…å­˜
df -h                                  # æ£€æŸ¥ç£ç›˜
```

---

## æ­å–œä½ ï¼

å¦‚æœä½ æŒ‰ç…§è¿™ä¸ªæ•™ç¨‹ä¸€æ­¥æ­¥æ“ä½œï¼Œä½ çš„ YuwenChat åº”è¯¥å·²ç»è¿è¡Œèµ·æ¥äº†ï¼

é‡åˆ°é—®é¢˜ï¼Ÿ
1. ä»”ç»†æ£€æŸ¥æ¯ä¸€æ­¥æ˜¯å¦æ­£ç¡®æ‰§è¡Œ
2. æŸ¥çœ‹æ—¥å¿—æ‰¾é”™è¯¯ä¿¡æ¯
3. æœç´¢é”™è¯¯ä¿¡æ¯
4. åˆ°é¡¹ç›® Issues æé—®

ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰
