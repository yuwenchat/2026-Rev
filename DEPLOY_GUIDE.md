# YuwenChat è¶…çº§æ— è„‘éƒ¨ç½²æŒ‡å—

> **çœ‹è¿™é‡Œï¼** è¿™ä¸ªæ•™ç¨‹æŠŠä½ å½“æˆå®Œå…¨ä¸æ‡‚çš„å°ç™½ï¼Œæ¯ä¸€æ­¥éƒ½æœ‰è¯¦ç»†è¯´æ˜ï¼Œå¤åˆ¶ç²˜è´´å°±èƒ½å®Œæˆï¼

---

## ğŸ¯ éƒ¨ç½²å‰å¿…è¯»ï¼ˆ2åˆ†é’Ÿï¼‰

### è¿™ä¸ªé¡¹ç›®å’Œæ™®é€šç½‘ç«™çš„åŒºåˆ«

| æ™®é€š PHP ç½‘ç«™ | YuwenChatï¼ˆæœ¬é¡¹ç›®ï¼‰ |
|--------------|-------------------|
| æ–‡ä»¶æ‰”è¿›å»å°±èƒ½ç”¨ | éœ€è¦å®‰è£…ä¾èµ– + æ„å»º |
| ä¸éœ€è¦é¢å¤–è¿›ç¨‹ | éœ€è¦ PM2 è·‘åç«¯ |
| ç›´æ¥è®¿é—®æ–‡ä»¶ | éœ€è¦é…ç½®åå‘ä»£ç† |

### æ•´ä½“æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         éƒ¨ç½²æµç¨‹ï¼ˆå…±9æ­¥ï¼‰                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â‘  å®‰è£…å®å¡”   â†’   â‘¡ å®‰è£…PM2å’ŒNginx   â†’   â‘¢ ä¸Šä¼ ä»£ç             â”‚
â”‚                                                                 â”‚
â”‚       â†“                                                         â”‚
â”‚                                                                 â”‚
â”‚  â‘£ ç»ˆç«¯æ‰§è¡Œä¸€é”®å‘½ä»¤ï¼ˆå®‰è£…ä¾èµ–+æ„å»º+å¯åŠ¨ï¼‰                         â”‚
â”‚                                                                 â”‚
â”‚       â†“                                                         â”‚
â”‚                                                                 â”‚
â”‚  â‘¤ æ·»åŠ ç½‘ç«™   â†’   â‘¥ é…ç½®Nginx   â†’   â‘¦ åŸŸåè§£æ                 â”‚
â”‚                                                                 â”‚
â”‚       â†“                                                         â”‚
â”‚                                                                 â”‚
â”‚  â‘§ ç”³è¯·SSLè¯ä¹¦   â†’   â‘¨ å¼€æ”¾é˜²ç«å¢™ç«¯å£   â†’   å®Œæˆï¼              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ç¬¬ä¸€éƒ¨åˆ†ï¼šå‡†å¤‡å·¥ä½œ

## æ­¥éª¤ 1ï¸âƒ£ ä¹°æœåŠ¡å™¨

### å»å“ªä¹°ï¼Ÿ

| æœåŠ¡å•† | ç½‘å€ | ç‰¹ç‚¹ |
|-------|------|-----|
| é˜¿é‡Œäº‘ | aliyun.com | å›½å†…æœ€å¤§ï¼Œéœ€å¤‡æ¡ˆ |
| è…¾è®¯äº‘ | cloud.tencent.com | ä¾¿å®œï¼Œéœ€å¤‡æ¡ˆ |
| Vultr | vultr.com | å›½å¤–ï¼Œå…å¤‡æ¡ˆï¼Œå¯èƒ½è¢«å¢™ |

### ä¹°ä»€ä¹ˆé…ç½®ï¼Ÿ

```
æœ€ä½é…ç½®ï¼š1æ ¸ 1Gå†…å­˜ 1Må¸¦å®½ï¼ˆçº¦50å…ƒ/æœˆï¼‰
æ¨èé…ç½®ï¼š2æ ¸ 2Gå†…å­˜ 3Må¸¦å®½ï¼ˆçº¦100å…ƒ/æœˆï¼‰

âš ï¸ é‡è¦ï¼šç³»ç»Ÿä¸€å®šè¦é€‰ Ubuntu 22.04ï¼ä¸è¦é€‰ CentOSï¼
```

### ä¹°å®Œåè®°ä¸‹è¿™äº›ä¿¡æ¯

```
ğŸ“ è®°åœ¨è®°äº‹æœ¬é‡Œï¼š

æœåŠ¡å™¨IP: _______________ï¼ˆä¾‹å¦‚ï¼š47.98.123.456ï¼‰
rootå¯†ç : _______________ï¼ˆä¹°çš„æ—¶å€™è®¾ç½®çš„ï¼‰
```

---

## æ­¥éª¤ 2ï¸âƒ£ ä¹°åŸŸå

### å»å“ªä¹°ï¼Ÿ

å’ŒæœåŠ¡å™¨åŒä¸€å®¶ä¹°æœ€æ–¹ä¾¿ï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘éƒ½æœ‰ï¼‰

### ä¹°ä»€ä¹ˆåŸŸåï¼Ÿ

```
ä¾‹å¦‚ï¼šchat.shawntv.co
åç¼€ .com çº¦ 55å…ƒ/å¹´
åç¼€ .co çº¦ 20å…ƒ/å¹´
```

### ä¹°å®Œåè®°ä¸‹

```
ğŸ“ ä½ çš„åŸŸå: chat.shawntv.co
```

---

## æ­¥éª¤ 3ï¸âƒ£ å®‰è£…å®å¡”é¢æ¿

### 3.1 è¿æ¥åˆ°æœåŠ¡å™¨

**Windows ç”¨æˆ·ï¼š**
```
1. ä¸‹è½½ PuTTYï¼šhttps://www.putty.org
2. æ‰“å¼€ PuTTY
3. Host Name å¡«ä½ çš„æœåŠ¡å™¨IP
4. ç‚¹ Open
5. å¼¹çª—ç‚¹ Yes
6. login as: è¾“å…¥ root å›è½¦
7. Password: è¾“å…¥ä½ çš„å¯†ç ï¼ˆä¸æ˜¾ç¤ºæ˜¯æ­£å¸¸çš„ï¼‰å›è½¦
8. çœ‹åˆ° root@xxx:~# å°±æˆåŠŸäº†ï¼
```

**Mac ç”¨æˆ·ï¼š**
```
1. æ‰“å¼€ã€Œç»ˆç«¯ã€
2. è¾“å…¥ï¼šssh root@ä½ çš„æœåŠ¡å™¨IP
3. è¾“å…¥ yes å›è½¦
4. è¾“å…¥å¯†ç å›è½¦
5. çœ‹åˆ° root@xxx:~# å°±æˆåŠŸäº†ï¼
```

### 3.2 å®‰è£…å®å¡”

å¤åˆ¶ä¸‹é¢è¿™ä¸€æ•´æ¡å‘½ä»¤ï¼Œç²˜è´´åˆ°ç»ˆç«¯ï¼Œå›è½¦æ‰§è¡Œï¼š

```bash
wget -O install.sh https://download.bt.cn/install/install-ubuntu_6.0.sh && sudo bash install.sh ed8484bec
```

ç­‰å¾… 2-5 åˆ†é’Ÿï¼Œå‡ºç°ä¸‹é¢çš„ä¿¡æ¯å°±å®‰è£…å¥½äº†ï¼š

```
==================================================================
Congratulations! Installed successfully!
==================================================================
å¤–ç½‘é¢æ¿åœ°å€: http://47.98.123.456:8888/abcdefgh
username: abcdefgh
password: 12345678
==================================================================

âš ï¸âš ï¸âš ï¸ é‡è¦ï¼æŠŠè¿™äº›ä¿¡æ¯æˆªå›¾æˆ–å¤åˆ¶ä¿å­˜ï¼âš ï¸âš ï¸âš ï¸
```

### 3.3 è®°ä¸‹å®å¡”ä¿¡æ¯

```
ğŸ“ å®å¡”é¢æ¿åœ°å€: ___________________________
ğŸ“ å®å¡”ç”¨æˆ·å: _______________
ğŸ“ å®å¡”å¯†ç : _______________
```

---

# ç¬¬äºŒéƒ¨åˆ†ï¼šå®å¡”é¢æ¿æ“ä½œ

## æ­¥éª¤ 4ï¸âƒ£ ç™»å½•å®å¡” + å®‰è£…è½¯ä»¶

### 4.1 ç™»å½•å®å¡”é¢æ¿

```
1. æ‰“å¼€æµè§ˆå™¨
2. åœ°å€æ è¾“å…¥ä½ çš„å®å¡”é¢æ¿åœ°å€
3. è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
4. ç™»å½•æˆåŠŸï¼

âš ï¸ é¦–æ¬¡ç™»å½•å¼¹å‡ºçš„ã€Œæ¨èå®‰è£…å¥—ä»¶ã€çª—å£ï¼Œç‚¹ Ã— å…³æ‰ï¼
```

### 4.2 å®‰è£… PM2 ç®¡ç†å™¨

```
ğŸ“ ä½ç½®ï¼šå·¦ä¾§èœå• â†’ã€Œè½¯ä»¶å•†åº—ã€

æ“ä½œæ­¥éª¤ï¼š
1. ç‚¹å‡»å·¦ä¾§ã€Œè½¯ä»¶å•†åº—ã€
2. æœç´¢æ¡†è¾“å…¥ã€ŒPM2ã€
3. æ‰¾åˆ°ã€ŒPM2ç®¡ç†å™¨ã€
4. ç‚¹å‡»å³è¾¹çš„ã€Œå®‰è£…ã€
5. å¼¹çª—ç‚¹ã€Œç¡®å®šã€
6. ç­‰å¾… 2-3 åˆ†é’Ÿ
7. çœ‹åˆ°ç»¿è‰²ã€Œè¿è¡Œä¸­ã€å°±æˆåŠŸäº†
```

### 4.3 å®‰è£… Nginx

```
ğŸ“ ä½ç½®ï¼šå·¦ä¾§èœå• â†’ã€Œè½¯ä»¶å•†åº—ã€

æ“ä½œæ­¥éª¤ï¼š
1. æœç´¢æ¡†è¾“å…¥ã€Œnginxã€
2. æ‰¾åˆ°ã€ŒNginxã€ï¼ˆä¸æ˜¯ OpenRestyï¼‰
3. ç‚¹å‡»ã€Œå®‰è£…ã€
4. ç‰ˆæœ¬é€‰ 1.24ï¼ˆæˆ–æœ€æ–°ï¼‰
5. å‹¾é€‰ã€Œæé€Ÿå®‰è£…ã€
6. ç‚¹ã€Œç¡®å®šã€
7. ç­‰å¾… 1-2 åˆ†é’Ÿå®Œæˆ
```

---

## æ­¥éª¤ 5ï¸âƒ£ ä¸Šä¼ é¡¹ç›®ä»£ç 

### 5.1 åˆ›å»ºç›®å½•

```
ğŸ“ ä½ç½®ï¼šå·¦ä¾§èœå• â†’ã€Œæ–‡ä»¶ã€

æ“ä½œæ­¥éª¤ï¼š
1. ç‚¹å‡»å·¦ä¾§ã€Œæ–‡ä»¶ã€
2. åœ°å€æ è¾“å…¥ï¼š/www/wwwroot
3. æŒ‰å›è½¦è¿›å…¥
4. ç‚¹å‡»ä¸Šæ–¹ã€Œæ–°å»ºç›®å½•ã€
5. åç§°è¾“å…¥ï¼šchat.shawntv.co
6. ç‚¹ã€Œç¡®å®šã€
```

### 5.2 ä¸Šä¼ ä»£ç 

**æ–¹æ³•Aï¼šä¸Šä¼ å‹ç¼©åŒ…ï¼ˆæ¨èå°ç™½ï¼‰**
```
1. æŠŠé¡¹ç›®æ‰“åŒ…æˆ .zip æ–‡ä»¶
2. åŒå‡»è¿›å…¥ chat.shawntv.co ç›®å½•
3. ç‚¹å‡»ä¸Šæ–¹ã€Œä¸Šä¼ ã€
4. é€‰æ‹©ä½ çš„ zip æ–‡ä»¶
5. ç­‰å¾…ä¸Šä¼ å®Œæˆ
6. å³é”®ç‚¹å‡» zip æ–‡ä»¶ â†’ã€Œè§£å‹ã€â†’ã€Œè§£å‹åˆ°å½“å‰ç›®å½•ã€
```

**æ–¹æ³•Bï¼šGit æ‹‰å–**
```
1. ç‚¹å‡»å·¦ä¾§ã€Œç»ˆç«¯ã€
2. æ‰§è¡Œå‘½ä»¤ï¼š

cd /www/wwwroot/chat.shawntv.co
git clone https://github.com/ä½ çš„ç”¨æˆ·å/yuwenchat.git .

æ³¨æ„æœ€åæœ‰ä¸ªç‚¹ï¼
```

### 5.3 ç¡®è®¤ä¸Šä¼ æˆåŠŸ

```
ğŸ“ ä½ç½®ï¼šå·¦ä¾§èœå• â†’ã€Œæ–‡ä»¶ã€â†’ /www/wwwroot/chat.shawntv.co/

ä½ åº”è¯¥çœ‹åˆ°è¿™äº›æ–‡ä»¶å¤¹ï¼š
âœ… client/      ï¼ˆå‰ç«¯ä»£ç ï¼‰
âœ… server/      ï¼ˆåç«¯ä»£ç ï¼‰
âœ… PLAN.md
âœ… README.md
```

---

## æ­¥éª¤ 6ï¸âƒ£ æ‰§è¡Œä¸€é”®éƒ¨ç½²å‘½ä»¤ â­æœ€å…³é”®çš„ä¸€æ­¥â­

### 6.1 æ‰“å¼€ç»ˆç«¯

```
ğŸ“ ä½ç½®ï¼šå·¦ä¾§èœå• â†’ã€Œç»ˆç«¯ã€
```

### 6.2 å¤åˆ¶ç²˜è´´è¿™ä¸€æ•´æ®µå‘½ä»¤

```bash
# ===== ä¸€é”®éƒ¨ç½²å‘½ä»¤ï¼ˆå…¨éƒ¨å¤åˆ¶ï¼Œç²˜è´´åˆ°ç»ˆç«¯ï¼Œå›è½¦æ‰§è¡Œï¼‰=====

cd /www/wwwroot/chat.shawntv.co && \
echo ">>> 1/5 åˆ›å»ºæ•°æ®ç›®å½•" && \
mkdir -p server/data && \
echo ">>> 2/5 å®‰è£…åç«¯ä¾èµ–ï¼ˆçº¦1-2åˆ†é’Ÿï¼‰" && \
cd server && npm install --registry=https://registry.npmmirror.com && \
echo ">>> 3/5 åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶" && \
cat > .env << 'EOF'
PORT=3000
NODE_ENV=production
JWT_SECRET=yuwenchat-secret-key-change-this-in-production
CLIENT_URL=https://chat.shawntv.co
DB_PATH=./data/chat.db
EOF
echo ">>> 4/5 å®‰è£…å‰ç«¯ä¾èµ–å¹¶æ„å»ºï¼ˆçº¦2-3åˆ†é’Ÿï¼‰" && \
cd ../client && npm install --registry=https://registry.npmmirror.com && npm run build && \
echo ">>> 5/5 å¯åŠ¨åç«¯æœåŠ¡" && \
cd ../server && pm2 delete yuwenchat 2>/dev/null; pm2 start src/index.js --name yuwenchat && pm2 save && \
echo "" && \
echo "========================================" && \
echo "âœ… éƒ¨ç½²å®Œæˆï¼" && \
echo "========================================"
```

### 6.3 æ‰§è¡Œç»“æœ

å¦‚æœçœ‹åˆ°è¿™ä¸ªï¼Œè¯´æ˜æˆåŠŸäº†ï¼š
```
========================================
âœ… éƒ¨ç½²å®Œæˆï¼
========================================
```

å¦‚æœæŠ¥é”™ï¼Œçœ‹ä¸‹é¢çš„ã€Œå¸¸è§é”™è¯¯å¤„ç†ã€ã€‚

### 6.4 éªŒè¯åç«¯è¿è¡ŒçŠ¶æ€

åœ¨ç»ˆç«¯æ‰§è¡Œï¼š
```bash
pm2 list
```

åº”è¯¥çœ‹åˆ°ï¼š
```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name     â”‚ status  â”‚ cpu     â”‚ memory   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0  â”‚ yuwenchatâ”‚ online  â”‚ 0%      â”‚ 45mb     â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

status æ˜¾ç¤º online = æˆåŠŸï¼
status æ˜¾ç¤º errored = å¤±è´¥ï¼Œçœ‹æ—¥å¿—ï¼špm2 logs yuwenchat --err
```

---

## æ­¥éª¤ 7ï¸âƒ£ æ·»åŠ ç½‘ç«™ â­é‡ç‚¹çœ‹è¿™é‡Œâ­

### 7.1 æ‰“å¼€æ·»åŠ ç½‘ç«™ç•Œé¢

```
ğŸ“ ä½ç½®ï¼šå·¦ä¾§èœå• â†’ã€Œç½‘ç«™ã€â†’ ç‚¹å‡»ã€Œæ·»åŠ ç«™ç‚¹ã€
```

### 7.2 å¡«å†™ä¿¡æ¯ï¼ˆç…§ç€å¡«ï¼ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ·»åŠ ç«™ç‚¹                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  åŸŸå:     chat.shawntv.co                                  â”‚
â”‚                                                             â”‚
â”‚  å¤‡æ³¨:     (å¯ä»¥ä¸å¡«)                                        â”‚
â”‚                                                             â”‚
â”‚  æ ¹ç›®å½•:   /www/wwwroot/chat.shawntv.co/client/dist         â”‚
â”‚            â†‘â†‘â†‘ é‡è¦ï¼ä¸€å®šè¦å¡«åˆ° distï¼â†‘â†‘â†‘                    â”‚
â”‚                                                             â”‚
â”‚  FTP:      ä¸åˆ›å»º                                            â”‚
â”‚                                                             â”‚
â”‚  æ•°æ®åº“:   ä¸åˆ›å»º                                            â”‚
â”‚                                                             â”‚
â”‚  PHPç‰ˆæœ¬:  çº¯é™æ€                                            â”‚
â”‚            â†‘ ä¸€å®šè¦é€‰ã€Œçº¯é™æ€ã€ï¼                            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‚¹å‡»ã€Œæäº¤ã€
```

### 7.3 å¸¸è§é”™è¯¯

```
âŒ é”™è¯¯ï¼šæ ¹ç›®å½•å¡«æˆäº† /www/wwwroot/chat.shawntv.co
âœ… æ­£ç¡®ï¼šæ ¹ç›®å½•è¦å¡« /www/wwwroot/chat.shawntv.co/client/dist

âŒ é”™è¯¯ï¼šPHPç‰ˆæœ¬é€‰äº† PHP-74
âœ… æ­£ç¡®ï¼šPHPç‰ˆæœ¬è¦é€‰ã€Œçº¯é™æ€ã€
```

---

## æ­¥éª¤ 8ï¸âƒ£ é…ç½® Nginxï¼ˆåå‘ä»£ç†ï¼‰â­è¶…é‡è¦â­

### 8.1 æ‰“å¼€ç½‘ç«™è®¾ç½®

```
ğŸ“ ä½ç½®ï¼šå·¦ä¾§ã€Œç½‘ç«™ã€â†’ æ‰¾åˆ°ä½ çš„ç½‘ç«™ â†’ ç‚¹å‡»ç½‘ç«™åç§°ï¼ˆæˆ–ç‚¹ã€Œè®¾ç½®ã€ï¼‰
```

### 8.2 æ‰“å¼€é…ç½®æ–‡ä»¶

```
ğŸ“ ä½ç½®ï¼šç½‘ç«™è®¾ç½®çª—å£ â†’ å·¦ä¾§ç‚¹ã€Œé…ç½®æ–‡ä»¶ã€
```

### 8.3 åˆ é™¤å…¨éƒ¨å†…å®¹ï¼Œç²˜è´´ä»¥ä¸‹é…ç½®

```nginx
server {
    listen 80;
    server_name chat.shawntv.co;

    # ========== å‰ç«¯æ–‡ä»¶ ==========
    root /www/wwwroot/chat.shawntv.co/client/dist;
    index index.html;

    # å‰ç«¯è·¯ç”±
    location / {
        try_files $uri $uri/ /index.html;
    }

    # ========== åç«¯APIä»£ç† ==========
    location /api {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # ========== WebSocketä»£ç†ï¼ˆèŠå¤©å¿…é¡»ï¼‰==========
    location /socket.io {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # æ—¥å¿—
    access_log /www/wwwlogs/chat.shawntv.co.access.log;
    error_log /www/wwwlogs/chat.shawntv.co.error.log;
}
```

### 8.4 ä¿å­˜é…ç½®

```
ç‚¹å‡»ã€Œä¿å­˜ã€æŒ‰é’®
```

### 8.5 æµ‹è¯•å¹¶é‡è½½ Nginx

åœ¨ç»ˆç«¯æ‰§è¡Œï¼š
```bash
nginx -t && nginx -s reload
```

çœ‹åˆ°è¿™ä¸ªå°±æˆåŠŸäº†ï¼š
```
nginx: configuration file /www/server/nginx/conf/nginx.conf test is successful
```

---

## æ­¥éª¤ 9ï¸âƒ£ åŸŸåè§£æ

### 9.1 å»åŸŸåç®¡ç†åå°

```
é˜¿é‡Œäº‘ï¼šhttps://dc.console.aliyun.com
è…¾è®¯äº‘ï¼šhttps://console.cloud.tencent.com/cns
Cloudflareï¼šhttps://dash.cloudflare.com
```

### 9.2 æ·»åŠ è§£æè®°å½•

```
ç‚¹å‡»ä½ çš„åŸŸå â†’ ç‚¹å‡»ã€Œæ·»åŠ è®°å½•ã€

å¡«å†™ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è®°å½•ç±»å‹:   A                                       â”‚
â”‚  ä¸»æœºè®°å½•:   chat                                    â”‚
â”‚  è®°å½•å€¼:     ä½ çš„æœåŠ¡å™¨IPï¼ˆä¾‹å¦‚ 47.98.123.456ï¼‰       â”‚
â”‚  TTL:        é»˜è®¤                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‚¹å‡»ã€Œç¡®å®šã€
```

### 9.3 ç­‰å¾…ç”Ÿæ•ˆ

```
åŸŸåè§£æéœ€è¦ 1-10 åˆ†é’Ÿç”Ÿæ•ˆ

éªŒè¯æ–¹æ³•ï¼ˆåœ¨ç»ˆç«¯æ‰§è¡Œï¼‰ï¼š
ping chat.shawntv.co

å¦‚æœæ˜¾ç¤ºä½ çš„æœåŠ¡å™¨IPï¼Œè¯´æ˜è§£ææˆåŠŸï¼
```

---

## æ­¥éª¤ ğŸ”Ÿ ç”³è¯· SSL è¯ä¹¦ï¼ˆHTTPSï¼‰

### 10.1 æ‰“å¼€ SSL è®¾ç½®

```
ğŸ“ ä½ç½®ï¼šç½‘ç«™ â†’ ä½ çš„ç½‘ç«™ â†’ è®¾ç½® â†’ å·¦ä¾§ç‚¹ã€ŒSSLã€
```

### 10.2 ç”³è¯·å…è´¹è¯ä¹¦

```
1. ç‚¹å‡»ã€ŒLet's Encryptã€é€‰é¡¹å¡
2. å‹¾é€‰ä½ çš„åŸŸå chat.shawntv.co
3. ç‚¹å‡»ã€Œç”³è¯·ã€
4. ç­‰å¾… 30 ç§’å·¦å³
5. ç”³è¯·æˆåŠŸåï¼Œå¼€å¯ã€Œå¼ºåˆ¶HTTPSã€å¼€å…³
```

### 10.3 å¦‚æœç”³è¯·å¤±è´¥

```
åŸå› 1: åŸŸåè§£æè¿˜æ²¡ç”Ÿæ•ˆ
â†’ ç­‰ 10 åˆ†é’Ÿå†è¯•

åŸå› 2: 80ç«¯å£æ²¡å¼€æ”¾
â†’ å¾€ä¸‹çœ‹ã€Œå¼€æ”¾é˜²ç«å¢™ç«¯å£ã€

åŸå› 3: åŸŸåæ²¡å¤‡æ¡ˆï¼ˆå›½å†…æœåŠ¡å™¨ï¼‰
â†’ å»åŸŸåæœåŠ¡å•†å¤‡æ¡ˆï¼Œæˆ–æ¢å›½å¤–æœåŠ¡å™¨
```

---

## æ­¥éª¤ 1ï¸âƒ£1ï¸âƒ£ å¼€æ”¾é˜²ç«å¢™ç«¯å£

### 11.1 å®å¡”é¢æ¿é˜²ç«å¢™

```
ğŸ“ ä½ç½®ï¼šå·¦ä¾§ã€Œå®‰å…¨ã€

æ·»åŠ ä»¥ä¸‹ç«¯å£ï¼š
- 80ï¼ˆHTTPï¼‰
- 443ï¼ˆHTTPSï¼‰
- 3000ï¼ˆåç«¯APIï¼Œå¯é€‰ï¼‰

æ“ä½œï¼šè¾“å…¥ç«¯å£å· â†’ ç‚¹ã€Œæ”¾è¡Œã€
```

### 11.2 äº‘æœåŠ¡å™¨å®‰å…¨ç»„

```
ğŸ“ ä½ç½®ï¼šé˜¿é‡Œäº‘/è…¾è®¯äº‘æ§åˆ¶å° â†’ äº‘æœåŠ¡å™¨ â†’ å®‰å…¨ç»„

æ·»åŠ å…¥ç«™è§„åˆ™ï¼š
- ç«¯å£ 80ï¼Œæ¥æº 0.0.0.0/0
- ç«¯å£ 443ï¼Œæ¥æº 0.0.0.0/0
```

---

# ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®Œæˆï¼

## ğŸ‰ éªŒè¯éƒ¨ç½²æˆåŠŸ

### æ‰“å¼€æµè§ˆå™¨è®¿é—®

```
https://chat.shawntv.co
```

### æ£€æŸ¥æ¸…å•

| æ£€æŸ¥é¡¹ | æ­£å¸¸æƒ…å†µ | å¼‚å¸¸å¤„ç† |
|-------|---------|---------|
| é¡µé¢èƒ½æ‰“å¼€ | çœ‹åˆ°ç™»å½•é¡µé¢ | æ£€æŸ¥ Nginx é…ç½® |
| åœ°å€æ æœ‰ğŸ”’ | æ˜¾ç¤ºå°é”å›¾æ ‡ | æ£€æŸ¥ SSL è¯ä¹¦ |
| èƒ½æ³¨å†Œè´¦å· | æ³¨å†ŒæˆåŠŸè·³è½¬ | æ£€æŸ¥åç«¯ `pm2 list` |
| èƒ½ç™»å½• | è¿›å…¥èŠå¤©ç•Œé¢ | æ£€æŸ¥åç«¯æ—¥å¿— |
| èƒ½å‘æ¶ˆæ¯ | æ¶ˆæ¯å®æ—¶æ˜¾ç¤º | æ£€æŸ¥ WebSocket ä»£ç† |

---

# å¸¸è§é—®é¢˜é€ŸæŸ¥

## âŒ é¡µé¢æ‰“ä¸å¼€ / 502 é”™è¯¯

```bash
# æ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ
pm2 list

# å¦‚æœ status ä¸æ˜¯ onlineï¼Œé‡å¯
pm2 restart yuwenchat

# çœ‹é”™è¯¯æ—¥å¿—
pm2 logs yuwenchat --err
```

## âŒ é¡µé¢æ˜¾ç¤º 404

```bash
# æ£€æŸ¥ dist ç›®å½•æ˜¯å¦å­˜åœ¨
ls /www/wwwroot/chat.shawntv.co/client/dist/

# å¦‚æœä¸å­˜åœ¨ï¼Œé‡æ–°æ„å»º
cd /www/wwwroot/chat.shawntv.co/client
npm run build
```

## âŒ æ³¨å†Œ/ç™»å½•å¤±è´¥

```bash
# æµ‹è¯•åç«¯æ˜¯å¦æ­£å¸¸
curl http://127.0.0.1:3000/api/health

# åº”è¯¥è¿”å› {"status":"ok"}
# å¦‚æœä¸è¡Œï¼Œæ£€æŸ¥åç«¯æ—¥å¿—
pm2 logs yuwenchat
```

## âŒ æ¶ˆæ¯å‘ä¸å‡ºå»

æ£€æŸ¥ Nginx é…ç½®é‡Œçš„ `/socket.io` éƒ¨åˆ†æ˜¯å¦æ­£ç¡®é…ç½®

## âŒ npm install æŠ¥é”™

```bash
# ä½¿ç”¨å›½å†…é•œåƒ
npm config set registry https://registry.npmmirror.com

# å¦‚æœæ˜¯ç¼–è¯‘é”™è¯¯
apt update && apt install -y build-essential python3

# é‡æ–°å®‰è£…
npm install
```

---

# ä¸€é”®å‘½ä»¤é€ŸæŸ¥è¡¨

```bash
# ===== é‡æ–°éƒ¨ç½²ï¼ˆå¦‚æœæç ¸äº†ï¼‰=====
cd /www/wwwroot/chat.shawntv.co/server && npm install && \
cd ../client && npm install && npm run build && \
cd ../server && pm2 restart yuwenchat

# ===== æŸ¥çœ‹åç«¯çŠ¶æ€ =====
pm2 list

# ===== æŸ¥çœ‹åç«¯æ—¥å¿— =====
pm2 logs yuwenchat

# ===== é‡å¯åç«¯ =====
pm2 restart yuwenchat

# ===== æµ‹è¯•åç«¯ =====
curl http://127.0.0.1:3000/api/health

# ===== æµ‹è¯• Nginx é…ç½® =====
nginx -t

# ===== é‡è½½ Nginx =====
nginx -s reload
```

---

# ğŸŠ æ­å–œï¼

å¦‚æœä½ çœ‹åˆ°äº†èŠå¤©ç•Œé¢ï¼Œè¯´æ˜éƒ¨ç½²æˆåŠŸäº†ï¼

è®°å¾—ï¼š
1. æŠŠé»˜è®¤å¯†ç æ”¹æ‰
2. å®šæœŸå¤‡ä»½æ•°æ®åº“ï¼ˆ`/www/wwwroot/chat.shawntv.co/server/data/chat.db`ï¼‰
3. æœ‰é—®é¢˜çœ‹æ—¥å¿—ï¼š`pm2 logs yuwenchat`

äº«å—ä½ çš„ç§å¯†èŠå¤©åº”ç”¨å§ï¼
